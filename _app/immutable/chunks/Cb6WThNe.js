const l=(e,t=0)=>{const r=Number(e);return Number.isFinite(r)?r:t},n={pageTitle:"Vantage Story",header:{title:"Vantage Story",description:""},context:{introText:"",emptyText:"No context for this keyframe."},renderer:{loading:"Loading renderer"},credits:{symbol:"Â©",label:"OpenStreetMap contributors",href:"https://www.openstreetmap.org/copyright"}},m=e=>typeof e=="string"?e.trim():"",o=(e,t)=>{const r=m(e);return r.length>0?r:t},p=e=>{const t=m(e);return t.length===0?"":/^(https?:|data:|blob:|\/\/|file:)/i.test(t)?t:`/${t.replace(/^\.\//,"").replace(/^\/+/,"")}`},T=e=>{const t=e&&typeof e=="object"?e:{},r=d=>d&&typeof d=="object"?d:{},i=r(t.header),s=r(t.context),a=r(t.renderer),c=r(t.credits);return{pageTitle:o(t.pageTitle,n.pageTitle),header:{title:o(i.title,n.header.title),description:m(i.description)},context:{introText:m(s.introText),emptyText:o(s.emptyText,n.context.emptyText)},renderer:{loading:o(a.loading,n.renderer.loading)},credits:{symbol:o(c.symbol,n.credits.symbol),label:o(c.label,n.credits.label),href:o(c.href,n.credits.href)}}},y=(e,t)=>{const r=e.id??`projection-${t+1}`,i=l(e.time,0),s=l(e.startTime,i),a=p(e.src),c=p(e.previewSrc)||a;return{...e,id:r,label:e.label??r,src:a,previewSrc:c,projectionType:e.projectionType??"perspective",time:i,startTime:s,cameraSelectable:e.cameraSelectable!==!1,keyframes:Array.isArray(e.keyframes)?e.keyframes:[]}},b=e=>{const t=e.flatMap(r=>{const i=r.keyframes.map(s=>l(s.time,0)+r.time);return[r.startTime,r.time,...i]});return Math.max(0,...t)},g=(e="")=>/\.(mp4|webm|ogg)(\?.*)?$/i.test(e),f=(e={})=>{const t=(Array.isArray(e.projections)?e.projections:[]).map(y),r=t.filter(s=>s.cameraSelectable).sort((s,a)=>s.startTime-a.startTime),i=b(t);return{sceneSrc:p(e.sceneSrc),maxTimelineTime:l(e.maxTimelineTime,i),projections:t,cameraTracks:r,ui:T(e.ui)}};export{g as i,f as r};
